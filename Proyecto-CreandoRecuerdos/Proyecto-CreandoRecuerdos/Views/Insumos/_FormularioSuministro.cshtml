@model Proyecto_CreandoRecuerdos.Models.InsumosModel

@{
    bool editando = (ViewBag.Editando != null) ? (bool)ViewBag.Editando : false;
    var suministroEditado = Model.SuministroEditado != null ? Model.SuministroEditado : new Proyecto_CreandoRecuerdos.Models.Suministro();
    string textoBoton = editando ? "Actualizar" : "Agregar";
    string accion = editando ? "EditarSuministro" : "CrearSuministro";
}

<!-- Formulario de registro/edición -->
<div class="container">
    <h4 class="mb-3"><strong>@(ViewBag.Editando == true ? "Edición de Suministros" : "Registro de Suministros")</strong></h4>
    @using (Html.BeginForm(accion, "Insumos", FormMethod.Post, new { @class = "needs-validation", id = "formSuministro" }))
    {
        @Html.AntiForgeryToken()

        if (editando)
        {
            @:<input type="hidden" name="id" value="@suministroEditado.id" />
        }

        <div class="mb-3 text-start">
            <label for="nombre" class="form-label">Nombre</label>
            <input type="text" name="nombre" id="nombre" class="form-control" value="@(editando ? suministroEditado.nombre : "")" />
            @if (ViewBag.ErroresPorCampo != null && ViewBag.ErroresPorCampo.ContainsKey("nombre"))
            {
                <span class="invalid-feedback" style="display:block">@ViewBag.ErroresPorCampo["nombre"]</span>
            }
        </div>

        <div class="mb-3 text-start">
            <label for="marca" class="form-label">Marca</label>
            <input type="text" name="marca" id="marca" class="form-control" value="@(editando ? suministroEditado.marca : "")" />
            @if (ViewBag.ErroresPorCampo != null && ViewBag.ErroresPorCampo.ContainsKey("marca"))
            {
                <span class="invalid-feedback" style="display:block">@ViewBag.ErroresPorCampo["marca"]</span>
            }
        </div>

        <div class="mb-3 text-start">
            <label for="presentacion" class="form-label">Presentación</label>
            <input type="text" name="presentacion" id="presentacion" class="form-control" value="@(editando ? suministroEditado.presentacion : "")" />
            @if (ViewBag.ErroresPorCampo != null && ViewBag.ErroresPorCampo.ContainsKey("presentacion"))
            {
                <span class="invalid-feedback" style="display:block">@ViewBag.ErroresPorCampo["presentacion"]</span>
            }
        </div>

        <div class="mb-3 text-start">
            <label for="proveedor" class="form-label">Proveedor</label>
            <input type="text" name="proveedor" id="proveedor" class="form-control" value="@(editando ? suministroEditado.proveedor : "")" />
            @if (ViewBag.ErroresPorCampo != null && ViewBag.ErroresPorCampo.ContainsKey("proveedor"))
            {
                <span class="invalid-feedback" style="display:block">@ViewBag.ErroresPorCampo["proveedor"]</span>
            }
        </div>

        <div class="mb-3 text-start">
            <label for="costo" class="form-label">Costo</label>
            <div class="input-group">
                <span class="input-group-text">₡</span>
                <input type="number" name="costo" id="costo" class="form-control" value="@(editando ? suministroEditado.costo.ToString("0.00", System.Globalization.CultureInfo.InvariantCulture) : "")" step="0.01" lang="en" />
            </div>
            @if (ViewBag.ErroresPorCampo != null && ViewBag.ErroresPorCampo.ContainsKey("costo"))
            {
                <span class="invalid-feedback d-block" style="display:block">@ViewBag.ErroresPorCampo["costo"]</span>
            }
        </div>

        <div class="mb-3 text-start">
            <label for="cantidad" class="form-label">Cantidad</label>
            <input type="number" name="cantidad" id="cantidad" class="form-control" value="@(editando ? suministroEditado.cantidad.ToString() : "")" />
            @if (ViewBag.ErroresPorCampo != null && ViewBag.ErroresPorCampo.ContainsKey("cantidad"))
            {
                <span class="invalid-feedback" style="display:block">@ViewBag.ErroresPorCampo["cantidad"]</span>
            }
        </div>

        <div class="mb-3 text-start">
            <label for="unidad_de_medida" class="form-label">Unidad de Medida</label>
            <input type="text" name="unidad_de_medida" id="unidad_de_medida" class="form-control" value="@(editando ? suministroEditado.unidad_de_medida : "")" />
            <span class="help-block" style="font-size:11px;">Palabras permitidas: unidad, unidades</span>
            @if (ViewBag.ErroresPorCampo != null && ViewBag.ErroresPorCampo.ContainsKey("unidad_de_medida"))
            {
                <span class="invalid-feedback" style="display:block">@ViewBag.ErroresPorCampo["unidad_de_medida"]</span>
            }
        </div>

        <!--RESULTADOS CALCULADOS-->

        <div class="mb-3 text-start">
            <label class="form-label">Costo por Cantidad (₡):</label>
            <div class="result-symbol">
                <span class="input-symbol-left">₡</span>
                <label id="costoPorCantidad" class="form-result">0.00</label>
            </div>
        </div>

        <div class="d-flex justify-content-end gap-2">
            @if (editando)
            {
                <a href="@Url.Action("implementos", "Insumos")" class="btn btn-secondary">Salir</a>
            }
            <button type="reset" class="btn btn-danger">Cancelar</button>
            <button type="submit" class="btn btn-custom-pink">@textoBoton</button>
        </div>
    }
</div>
